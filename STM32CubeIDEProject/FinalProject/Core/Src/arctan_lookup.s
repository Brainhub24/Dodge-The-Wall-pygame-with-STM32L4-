.section .data
.align 4
    @ Use a larger table with more entries
lookup:
.float 0.0, 0.0099, 0.0198, 0.02969, 0.03958, 0.04946, 0.05934, 0.0692, 0.07904, 0.08887, 0.09869, 0.10848, 0.11826, 0.12801, 0.13774, 0.14744, 0.15711, 0.16675, 0.17637, 0.18595, 0.19549, 0.205, 0.21447, 0.2239, 0.2333, 0.24265, 0.25196, 0.26122, 0.27044, 0.27961, 0.28873, 0.2978, 0.30683, 0.3158, 0.32472, 0.33358, 0.3424, 0.35115, 0.35986, 0.3685, 0.37709, 0.38562, 0.39409, 0.4025, 0.41085, 0.41914, 0.42737, 0.43554, 0.44365, 0.4517, 0.45968, 0.4676, 0.47546, 0.48325, 0.49098, 0.49865, 0.50626, 0.5138, 0.52128, 0.52869, 0.53604, 0.54333, 0.55055, 0.55771, 0.5648, 0.57184, 0.57881, 0.58571, 0.59256, 0.59934, 0.60606, 0.61272, 0.61931, 0.62585, 0.63232, 0.63873, 0.64508, 0.65137, 0.65761, 0.66378, 0.66989, 0.67595, 0.68194, 0.68788, 0.69376, 0.69959, 0.70536, 0.71107, 0.71672, 0.72232, 0.72787, 0.73336, 0.7388, 0.74418, 0.74952, 0.7548, 0.76002, 0.7652, 0.77032, 0.7754, 0.78042
.section .text
.global arctan_lookup

arctan_lookup:
    @ Input: r0 (x)
    @ Output: r1 (result)
	PUSH {r4-r7}
	ldr r2, =lookup
	mov r7, #0
    cmp r0, r7
    blt negative
    mov r4, r0
    mov r6, #4
    mul r6,r6,r4
    add r2, r2, r6
    vldr.f32 s0, [r2]
    VSTR.F32 s0, [r1]
    B done
negative:
	sub r4, r7, r0
	mov r6,#4
    mul r6,r6,r4
    add r2, r2, r6
    vldr.f32 s0, [r2]
	vneg.f32 s0, s0
	VSTR.F32 s0, [r1]
done:
	POP {r4-r7}
    //ldr r0, [r5]
    BX LR
